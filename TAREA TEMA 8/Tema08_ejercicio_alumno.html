<!DOCTYPE html>
<html lang="es">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ejercicios – Tema 8 con Bootstrap 5</title>
	<!-- Bootstrap 5 CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<style>
		.card+.card {
			margin-top: 1rem
		}
	</style>
</head>

<body class="bg-light">
	<div class="container pgit 
			<h1 class=" mb-4">Ejercicios - Tema 8: Validación de formularios</h1>
		<p class="text-muted">Se mantiene el patrón de validación con <code>addEventListener('submit', …)</code> y
			validación HTML5 donde corresponde.</p>

		<!-- EJ1 -->
		<div class="card">
			<div class="card-header">Ejercicio 1 – JS básico</div>
			<div class="card-body">
				<form id="bs-form-ej1" class="row g-3" novalidate>
					<div class="col-md-6">
						<label for="usuario" class="form-label">Usuario</label>
						<input class="form-control" type="text" name="usuario">
					</div>
					<div class="col-md-6">
						<label for="clave" class="form-label">Contraseña</label>
						<input class="form-control" type="password" name="clave">
					</div>
					<div class="col-12">
						<button class="btn btn-primary" type="submit">Enviar</button>
					</div>
				</form>
				<div id="bs-msg-ej1" class="mt-2"></div>
			</div>
		</div>

		<!-- EJ2 -->
		<div class="card">
			<div class="card-header">Ejercicio 2 – Validación HTML5 nativa</div>
			<div class="card-body">
				<form id="bs-form-ej2" class="row g-3">
					<div class="col-md-6">
						<label for="email" class="form-label">Email</label>
						<input class="form-control" type="email" name="email" required>
					</div>
					<div class="col-md-6">
						<label for="edad" class="form-label">Edad</label>
						<input class="form-control" type="number" name="edad" min="18" max="120" required>
					</div>
					<div class="col-md-6">
						<label for="clave2" class="form-label">Contraseña</label>
						<input class="form-control" type="password" name="clave2" minlength="6" required>
					</div>
					<div class="col-12">
						<button class="btn btn-primary" type="submit">Enviar</button>
					</div>
				</form>
				<div id="bs-msg-ej2" class="mt-2"></div>
			</div>
		</div>

		<!--EJ3-->
		<div class="card">
			<div class="card-header">Ejercicio 3 – Validación con patrón (Pattern)</div>
			<div class="card-body">
				<form id="bs-form-ej3" class="row g-3">
					<div class="col-md-6">
						<label for="nombre" class="form-label">Nombre y apellidos</label>
						<input class="form-control" type="text" name="nombre" required
							pattern="[A-Za-zÁÉÍÓÚáéíóúÑñ\- ]+"
							title="Caracteres permitidios: letras(mayúsculas y minusculas), vocales acentuadas, ñ y Ñ, espacios y guiones (-)">
					</div>
					<div class="col-12">
						<button class="btn btn-primary" type="submit">Enviar</button>
					</div>
				</form>
				<div id="bs-msg-ej3" class="mt-2"></div>
			</div>

		</div>

		<!--EJ4-->
		<div class="card">
			<div class="card-header">Ejercicio 4 – Coincidencia de contraseñas</div>
			<div class="card-body">
				<form id="bs-form-ej4" class="row g-3">
					<div class="col-md-6">
						<label for="clave4" class="form-label">Contraseña</label>
						<input class="form-control" type="password" name="clave4" minlength="6" required>
					</div>
					<div class="col-md-6">
						<label for="repetir_clave" class="form-label">Repetir contraseña</label>
						<input class="form-control" type="password" name="repetir_clave" minlength="6" required>
					</div>
					<div class="col-12">
						<button class="btn btn-primary" type="submit">Registrar</button>
					</div>
				</form>
				<div id="bs-msg-ej4" class="mt-2"></div>
			</div>
		</div>

		<!--EJ5-->
		<div class="card">
			<div class="card-header">Ejercicio 5 – Registro completo</div>
			<div class="card-body">
				<form id="bs-form-ej5" class="row g-3">
					<div class="col-md-6">
						<label for="nombre" class="form-label">Nombre y apellidos</label>
						<input class="form-control" type="text" name="nombre" pattern="[A-Za-zÁÉÍÓÚáéíóúÑñ\- ]+"
							title="Caracteres permitidios: letras(mayúsculas y minusculas), vocales acentuadas, ñ y Ñ, espacios y guiones (-)"
							required>
					</div>
					<div class="col-md-6">
						<label for="email" class="form-label">Email</label>
						<input class="form-control" type="email" name="email" required>
					</div>
					<div class="col-md-6">
						<label for="edad" class="form-label">Edad</label>
						<input class="form-control" type="number" name="edad" min="16" max="120" required>
					</div>
					<div class="col-md-6">
						<label for="clave5" class="form-label">Contraseña</label>
						<input class="form-control" type="password" name="clave5" minlength="6" required>
					</div>
					<div class="col-md-6">
						<label for="repetir_clave5" class="form-label">Repetir contraseña</label>
						<input class="form-control" type="password" name="repetir_clave5" minlength="6" required>
					</div>
					<div class="col-md-12">
						<div class="form-check">
							<input class="form-check-input" type="checkbox" name="acepta" id="acepta" required>
							<label class="form-check-label" for="acepta">Acepto los términos</label>
						</div>
					</div>
					<div class="col-12">
						<button class="btn btn-primary" type="submit">Enviar</button>
					</div>
				</form>
				<div id="bs-msg-ej5" class="mt-2"></div>
			</div>
		</div>

		<!-- Bootstrap 5 JS (bundle con Popper) -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
			crossorigin="anonymous"></script>
		<script>
			// TODO: Aquí va el código de validación 
			document.getElementById('bs-form-ej1').addEventListener('submit', function (e) {
				e.preventDefault(); //Evita que se envie autotmaticamente

				//Validación
				const usuario = this.usuario.value.trim();
				const clave = this.clave.value.trim();
				const mensaje = document.getElementById('bs-msg-ej1');

				if (usuario === '' || clave === '') {
					mensaje.textContent = 'Es obligatorio rellenar todos los campos';
					mensaje.className = ' alert alert-danger';
					return; //El return es necesario en los IF para el correcto funcionamiento.
				}

				mensaje.textContent = 'Formulario enviado correctamente';
				mensaje.className = ' alert alert-success';

				// Si quisiera enviarlo realmente lo dejaría sin comentar, pero como quiero que se muestre el mensaje lo dejo.
				// this.submit();
			});
		</script>

		<script>
			document.getElementById('bs-form-ej2').addEventListener('submit', function (e) {
				e.preventDefault(); // Evita que se envíe automáticamente.

				//No tenemos que revalidar los campos manualmente (ni comprobar si están vacíos, ni mirar si el email es correcto, etc.).
				// Si hay errores, el navegador mostrará los mensajes nativos automáticamente

				const mensaje = document.getElementById('bs-msg-ej2');
				mensaje.textContent = 'Formulario enviado correctamente';
				mensaje.className = 'alert alert-success';
				// Si quisiera enviarlo realmente lo dejaría sin comentar pero como quiero que se muestre el mensaje lo dejo.
				// this.submit();
			});
		</script>

		<!--Script -->
		<script>
			document.getElementById('bs-form-ej3').addEventListener('submit', function (e) {
				e.preventDefault(); // Evitamos envío real
				const mensaje = document.getElementById('bs-msg-ej3');

				// Si pasa la validación nativa del navegador
				if (this.checkValidity()) {
					mensaje.textContent = 'Formulario enviado correctamente.';
					mensaje.className = 'alert alert-success';
					// this.submit();
				} else {
					// Fuerza al navegador a mostrar los mensajes nativos de error
					this.reportValidity();
				}
			});
		</script>

		<script>
			document.getElementById('bs-form-ej4').addEventListener('submit', function (e) {
				e.preventDefault(); // evita envío 
				const mensaje = document.getElementById('bs-msg-ej4');

				const clave1 = this.clave4.value.trim();
				const clave2 = this.repetir_clave.value.trim();

				// Si coinciden
				if (clave1 === clave2) {
					mensaje.textContent = 'Formulario enviado correctamente.';
					mensaje.className = 'alert alert-success';
					//this.submit(); Se deja comentado porque si no envia el formulario y no muestra mensaje del div.
					return; // detiene  envío
				} else {
					// Si no coinciden
					mensaje.textContent = 'Las contraseñas no coinciden. Formulario no enviado.';
					mensaje.className = 'alert alert-danger';
				}
			});
		</script>

		<script>
			document.getElementById('bs-form-ej5').addEventListener('submit', function (e) {
				e.preventDefault(); // Evita el envío 
				const mensaje = document.getElementById('bs-msg-ej5');

				// Si pasa la validación nativa del navegador pasamos a la siguiente validación.
				if (this.checkValidity()) {
					// Comparamos que las contraseñas coincidan
					const clave1 = this.clave5.value.trim();
					const clave2 = this.repetir_clave5.value.trim();

					if (clave1 === clave2) { // Si son iguales, recogemos los datos en un objeto
						const datos = {
							nombre: this.nombre.value.trim(),
							email: this.email.value.trim(),
							edad: parseInt(this.edad.value),
							acepta_terminos: this.acepta.checked //.checked devuelve true si el usuario marcó el checkbox, o false si no.
						};

						// Mostramos los datos en formato JSON en el <div>
						// El segundo parámetro (null) se deja así porque no necesitamos reemplazar nada.
						// El tercero (2) es para indentar el JSON con 2 espacios,  lo  que lo hace más legible.
						mensaje.textContent = JSON.stringify(datos, null, 2); // JSON.stringify(datos) convierte el objeto datos en un texto JSON para poder mostrarlo en pantalla.
						mensaje.className = 'alert alert-success';
						//Quito el submit para que no envie el formulario y se vea el mensaje.
						// this.submit(); //Enviamos el formularo
					} else {
						mensaje.textContent = 'Las contraseñas no coinciden.';
						mensaje.className = 'alert alert-danger';
					}
				} else {
					this.reportValidity(); //Si no pasa la validación nativa del navegador muestra mensajes automáticos si hay errores
				}
			});
		</script>

</body>

</html>
